%
% Copyright (C) 2020 The LaTeX3 Project
%

\documentclass{minimal}

\input{regression-test}

\RequirePackage[enable-debug]{expl3}
\RequirePackage{l3color}
\ExplSyntaxOn
\debug_on:n { check-declarations , deprecation , log-functions }
\ExplSyntaxOff

\START

\AUTHOR{Joseph Wright}

\ExplSyntaxOn

\OMIT
  \cs_set_protected:Npn \test:n #1
    {
      \hbox_set:Nn \l_tmpa_box
        {
          \group_begin:
            #1
            Hello
          \group_end:
        }
      \box_show:N \l_tmpa_box
    }
\TIMO

\TEST { Multiple~models:~selecting }
  {
    \test:n { \color_select:nn { gray / rgb } { 0.1 / 0.1 , 0.1 , 0.2 } }
    \group_begin:
      \tl_set:Nn \l_color_fixed_model_tl { rgb }
      \test:n { \color_select:nn { gray / rgb } { 0.1 / 0.1 , 0.1 , 0.2 } }
    \group_end:
    \test:n
      {
        \color_select:nn { rgb / cmyk }
          { 0.1 , 0.2 , 0.3 / 0.1 , 0.2 , 0.3 , 0.4 }
      }
    \group_begin:
      \tl_set:Nn \l_color_fixed_model_tl { cmyk }
      \test:n
         {
           \color_select:nn { rgb / cmyk }
             { 0.1 , 0.2 , 0.3 / 0.1 , 0.2 , 0.3 , 0.4 }
         }
    \group_end:
    \group_begin:
      \tl_set:Nn \l_color_fixed_model_tl { gray }
      \test:n
         {
           \color_select:nn { rgb / cmyk }
             { 0.1 , 0.2 , 0.3 / 0.1 , 0.2 , 0.3 , 0.4 }
         }
    \group_end:
  }

\TEST { Multiple~models:~named }
  {
    \color_set:nnn { foo1 } { cmyk / rgb }
      { 0.1 , 0.2 , 0.3 , 0.4 / 0.1 , 0.1 , 0.2 }
    \color_set:nn { test } { cyan!50!foo1 }
    \color_show:n { test }
    \color_set:nn { test } { blue!50!foo1 }
    \color_show:n { test }
  }

\TEST { Showing~multiple~models }
  {
    \color_set:nnn { foo1 } { cmyk / rgb }
      { 0.1 , 0.2 , 0.3 , 0.4 / 0.1 , 0.1 , 0.2 }
    \color_show:n { foo1 }
  }

\END
